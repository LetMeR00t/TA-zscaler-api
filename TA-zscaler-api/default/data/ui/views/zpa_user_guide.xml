<form version="1.1">
  <label>ZPA (Zscaler Private Access)</label>
  <description>This dashboard is used to summarize how you could interact with ZPA</description>
  <init>
    <set token="ref_url">https://github.com/mitchos/pyZscaler/blob/1.1.0/pyzscaler</set>
    <set token="ref_tool">zpa</set>
  </init>
  <fieldset submitButton="false">
    <input type="text" token="account">
      <label>Account name (defined under "Configuration")</label>
    </input>
    <input type="dropdown" token="action">
      <label>Action</label>
      <choice value="create_app_segment">App Segment: Create</choice>
      <choice value="update_app_segment">App Segment: Update</choice>
      <choice value="delete_app_segment">App Segment: Delete</choice>
    </input>
  </fieldset>
  <row>
    <panel>
      <html>
        <h1>Create/Update/Delete an application segment</h1>
        <h2 style="color:#56BA56">
          <b>
            <i>Template</i>
          </b>
        </h2>
        <p>If you want to execute an action from Splunk to Zscaler ZPA regarding application segments, you can use the below code to achieve what you want to do</p>
        <p style="color:#FF0000">| makeresults | &lt; Your input fields here using an 'eval' command &gt; | sendalert zscaler_zpa_action param.account_name="$account$" param.action="$action$"</p>
        <br/>
        <p>
          <b>Note</b>: Specific IDs such as segment_group_id or server_group_id can be recovered using the input defined in this application</p>
        <br/>
        <h2 style="color:#56BA56">
          <b>
            <i>Examples</i>
          </b>
        </h2>
        <p>
          <b>Create an application segment</b>: (Ref: <a href="$ref_url$/$ref_tool$/app_segments.py#L61" target="_blank">app_segments.py#L61</a>)</p> 
        <p>| makeresults | eval name = "MyName", domain_names = "mydomain.tld", tcp_ports = "80,80", bypass_type = "ALWAYS", segment_group_id = "123456789", server_group_ids = "987654321", description = "My custom description for my new application segment" | sendalert zscaler_zpa_action param.account_name="$account$" param.action="create_app_segment"</p>
        <p>
          <b>Update an application segment</b>: (here, only the name and description) (Ref: <a href="$ref_url$/$ref_tool$/app_segments.py#L150" target="_blank">app_segments.py#L150</a>)</p>
        <p>| makeresults | eval segment_id = "123456789", description = "My updated description here", name = "MyNewName" | sendalert zscaler_zpa_action param.account_name="$account$" param.action="update_app_segment"</p>
        <p>
          <b>Delete an application segment</b>: (Ref: <a href="$ref_url$/$ref_tool$/app_segments.py#L44" target="_blank">app_segments.py#L44</a>)</p>
        <p>| makeresults | eval segment_id = "123456789" | sendalert zscaler_zpa_action param.account_name="$account$" param.action="delete_app_segment"</p>
      </html>
    </panel>
  </row>
</form>